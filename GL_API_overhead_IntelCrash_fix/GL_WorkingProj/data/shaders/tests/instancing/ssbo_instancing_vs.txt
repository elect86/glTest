#version 430
#extension GL_ARB_shader_storage_buffer_object : require

in vec3 s_pos;
in vec3 s_normal;
in vec2 s_uv;

uniform mat4 ModelViewProjectionMatrix;

//ssbo should be binded to 0 binding point
layout(std430, binding = 0) buffer ssboData
{
    vec4 instance_data[4096];
};

out vec3 instance_color;

void main()
{
//gl_InstanceID is unique for each instance. So we able to set per instance data
	vec4 instance_pos = instance_data[gl_InstanceID*2];
	instance_color = instance_data[gl_InstanceID*2+1].xyz;
	gl_Position = ModelViewProjectionMatrix * vec4(s_pos + instance_pos.xyz, 1.0);
}